
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Shiny happy people coding</title>
  <meta name="author" content="Cyril Mougel">

  
  <meta name="description" content="Alors que j&#8217;ai cherché comment tester facilement Devise. J&#8217;ai indiqué une technique dans mon précédent post. Mais cette technique est &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.shingara.fr//blog/page/2/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Shiny happy people coding" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-11352302-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Shiny happy people coding</a></h1>
  
    <h2>Codons avec le sourire</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.shingara.fr/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/comment-tester-devise-reelement.html">Comment tester devise ? réélement ?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-30T00:00:00+01:00" pubdate data-updated="true">Nov 30<span>th</span>, 2009</time>
        
         | <a href="/comment-tester-devise-reelement.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Alors que j&#8217;ai cherché comment tester facilement <a href="http://github.com/plataformatec/devise">Devise</a>. J&#8217;ai indiqué une technique dans <a href="http://blog.shingara.fr/devise-cest-bien-mais-il-faut-le-tester.html">mon précédent post</a>. Mais cette technique est loin d&#8217;être la meilleure. Voici donc la nouvelle solution, la solution officielle.</p>

<p>Il suffit d&#8217;inclure <code>Devise::TestHelpers</code>. Ensuite pour se logger avec un utilisateur, on utilise la méthode <code>sign_in</code>. La méthode <code>sign_out</code> existe aussi.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/devise-cest-bien-mais-il-faut-le-tester.html">Devise ? c&#8217;est bien, mais il faut le tester.</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-19T00:00:00+01:00" pubdate data-updated="true">Nov 19<span>th</span>, 2009</time>
        
         | <a href="/devise-cest-bien-mais-il-faut-le-tester.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Alors que j&#8217;ai évoqué ma <a href="http://blog.shingara.fr/oupsnow-de-merb-i-rails.html">migration de Merb à Rails pour
Oupsnow</a>, il a
fallu trouver un système d&#8217;authentification ORM Agnostique.</p>

<p>Le plugin d&#8217;authentification le plus connu à l&#8217;heure actuel est <a
href="http://rdoc.info/projects/binarylogic/authlogic">Authlogic</a>.
Ce plugin est vraiment très performant, mais tous les essais de le rendre ORM
Agnostique ont été vain. C&#8217;est alors qu&#8217;au même moment, durant le <a
href="http://www.railssummit.com.br/">Rails Summit 2009</a>,
George Guimarães et Carlos Antonio annoncent la sortie de <a
href="http://github.com/plataformatec/devise">Devise</a>, un plugin Rails au
dessus de <a href="http://github.com/hassox/warden">Warden</a> (
Rack middleware d&#8217;authentification). C&#8217;est exactement, ce qu&#8217;il me faut, un
nouveau système d&#8217;authentification a tester et peut-être une possibilité
d&#8217;ajouter une couche d&#8217;ORM Agnostique dedans. En plus Warden étant un
RackMiddleware, je pourrais un peu tester ce que ça donne.</p>

<p>J&#8217;installe donc Devise et commence à l&#8217;utiliser dans Oupsnow. Tout se passe
à merveille, jusqu&#8217;au moment où il faut faire les tests. Tout de suite le bât
blesse. Les tests controlleurs de Rails ne communiquent pas avec la couche Rack
qui n&#8217;est pas initialisée. On se retrouve donc avec une impossibilité de
définir si un utilisateur est loggé ou non et si oui, qui est cet
utilisateur.</p>

<p>Après de nombreux tests et essais. J&#8217;ai fini par trouver comment faire.
Warden ajoute à la requête une variable d&#8217;environment dans la requête. On peux
y accéder par
<code>request.env['warden']</code>. Il suffit donc de remplir cette
variable.</p>

<p>Pour avoir un utilisateur non loggé, il faut faire :</p>

<typo:code lang="ruby">
def unlogged
  request.env[&#8216;warden&#8217;] = Warden::Proxy.new(request.env, {:default_strategies => [:rememberable, :authenticable],:silence_missing_strategies => true})
end
</typo:code>

<p>Pour se logger avec un utilisateur en particulier il faut faire :</p>

<typo:code lang="ruby">
def logged_as(user)
  proxy = Warden::Proxy.new(request.env, {:default_strategies => [:rememberable, :authenticable], :silence_missing_strategies => true})
  proxy.set_user(user, :store => true, :scope => :user)
  request.env[&#8216;warden&#8217;] = proxy
end
</typo:code>

<p>Personnellement, j&#8217;aime beaucoup <a href="http://github.com/plataformatec/devise">devise</a>. A tel point que j&#8217;ai permis de le
rendre ORM Agnostique et compatible avec <a href="http://github.com/jnunemaker/mongomapper/">MongoMapper</a>.</p>

<p>EDIT du 30 Novembre 2009: la technique indiquée ici n&#8217;est pas optimum et ne marche pas avec les dernières versions de Devise. utilisez plutôt la technique décrite dans mon ticket <a href="http://blog.shingara.fr/comment-tester-devise-reelement.html">Comment tester devise ? réélement ?</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/oupsnow-de-merb-i-rails.html">Oupsnow de Merb à Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-18T00:00:00+01:00" pubdate data-updated="true">Nov 18<span>th</span>, 2009</time>
        
         | <a href="/oupsnow-de-merb-i-rails.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Dernièrement, j&#8217;ai fini par me décider de migrer <a
href="http://oupsnow.rubyforge.org">Oupsnow</a>, de Merb à Rails.</p>

<p>Alors que je
finissais une migration de SQL à MongoDB, j&#8217;en entame une nouvelle. Celle-ci
beaucoup plus profonde.</p>

<p>La raison de ma migration ?</p>

<p>Rails 3. En
effet, depuis Décembre 2008, soit presque un an, Merb s&#8217;est figé.
Certain me diront que la communauté Merb est en train de revivre et c&#8217;est tout
à fait vrai. J&#8217;en suis même ravi. Mais Merb a pris un immense retard en
presque un an. Même si Rails n&#8217;a pas vraiment avancé dans sa version stable,
sa version Edge a elle énormément avancée.</p>

<p>Voulant toujours tester les
nouvelles technologies en Ruby, je voudrais tester Rails 3. Mais aucun système
n&#8217;existe pour passer de Merb à Rails 3. Un rapide test m&#8217;a montré que la
différence était par contre minime entre Rails 2.3.x et Rails 3. La
migration de Rails 2.3.x à Rails 3 en sera donc d&#8217;autant plus simple.</p>

<p>Voulant vraiment sortir une version stable le plus vite possible, j&#8217;ai
donc pris la décision de migrer Oupsnow vers Rails 2.3.x pour ensuite migrer
sur Rails 3 pour cette fois sortir une version de Oupsnow compatible Rails 3.</p>

<p>Oupsnow devient donc un projet Rails/MongoMapper et non plus
Merb/DataMapper comme sa dernière version. Toute aide est bien-sûr la
bienvenue.</p>

<p><a href="http://blog.shingara.fr/en/2009-11-19-oupsnow-from-merb-to-rails.html">English translation</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/rabbitmq-ne-marche-pas-avec-mac-os.html">RabbitMQ ne marche pas avec Mac OS ?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-04T00:00:00+01:00" pubdate data-updated="true">Nov 4<span>th</span>, 2009</time>
        
         | <a href="/rabbitmq-ne-marche-pas-avec-mac-os.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Il y a quelque semaine, alors que je me remettais tout simplement à l&#8217;utilisation de <a href="http://www.rabbitmq.com/">RabbitMQ</a>, j&#8217;ai eu un gros problème. Alors qu&#8217;il faut configurer les vhost et les utilisateurs de RabbitMQ, impossible de contacter mon service rabbitMQ avec la commande <code>rabbitmqctl</code>. Prévoyant une migration vers Mac OS Snow Leopard et n&#8217;ayant pas un besoin urgent de RabbitMQ, j&#8217;ai repoussé la recherche du problème.</p>

<p>Mais voilà, maintenant que je suis sous Mac Os Snow Leopard, j&#8217;ai réinstaller RabbitMQ pour le réutiliser à nouveau. Et là, surprise toujours le même soucis. Après de longue recherche, je viens enfin de trouver la cause, le hostname.</p>

<p>Que faire si votre noeud de contrôle rabbitMQ n&#8217;arrive pas à discuter avec le noeud maitre ?</p>

<p>Très simple, faite un simple <code>hostname -s</code> et ajouter ce hostname en concordance de l&#8217;ip 127.0.0.1 dans votre fichier <code>/etc/hosts</code>. Ça y est tout fonctionne. C&#8217;est parfois tellement simple la résolution d&#8217;un problème.</p>

<p><a href="http://blog.shingara.fr/en/2009-11-18-rabbitmq-doesn-t-works-with-macosx.html">English translation</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/le-logger-ruby-avec-son-bloc.html">Le logger ruby avec son bloc</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-21T00:00:00+02:00" pubdate data-updated="true">Oct 21<span>st</span>, 2009</time>
        
         | <a href="/le-logger-ruby-avec-son-bloc.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Alors que je m&#8217;amusais à étendre le Logger de base de Ruby, j&#8217;ai découvert que l&#8217;on pouvait utiliser le Logger comme ci-dessous :</p>

<typo:code lang="ruby">
Logger.debug { &#8220;My object is #{self.map(&:id)}&#8221; }
</typo:code>

<p>Par défaut, on l&#8217;utilise en fournissant une string en paramètre comme ceci : <code>Logger.debug("My object is #{self.map(&:id)}")</code>.</p>

<p>La différence entre ces deux écritures ?</p>

<p>La première permet d&#8217;éviter d&#8217;évaluer la chaine qui sera loggé si elle n&#8217;en a pas besoin. Contrairement à la deuxième qui sera toujours évaluée même si vous ne la loggez pas. Ainsi le temps de traitement pourrais s&#8217;en faire ressentir.</p>

<p>Grâce à ça, on peux facilement éviter les fameux :</p>

<typo:code lang="ruby">
Logger.debug(&#8220;My object is #{self.map(&:id)}&#8221;) if Logger.level == Logger::DEBUG
</typo:code>

<p>En effet, ce genre de code est très fréquent en Java, pour gagner un petit peu en performance sans perdre ses logs.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/pourquoi-rspec-au-lieu-de-test-unit.html">Pourquoi Rspec au lieu de Test::Unit?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-04T00:00:00+02:00" pubdate data-updated="true">Oct 4<span>th</span>, 2009</time>
        
         | <a href="/pourquoi-rspec-au-lieu-de-test-unit.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Dernièrement, on m&#8217;a posé la question toute bête :</p>

 <p><strong>Pourquoi Rspec au lieu de Test::Unit ?</strong>

 <p>C&#8217;est vrai que je suis un adepte de <a href="http://rspec.info/">Rspec</a> et que je n&#8217;utilise que ça si c&#8217;est possible. mais je
 n&#8217;ai jamais expliqué ici clairement ce qui me pousse dans ce choix. Donc
 voici un résumé très bref de mon choix.</p>

 <h2>Les formateurs</h2>

<p>
 Une des options méconnues de Rspec est la possibilité de définir son formateur.
 Il existe ainsi plusieurs formateurs base. On peux ainsi avoir un retour
 direct sous format HTML ou text avec les points ( classique avec Test::Unit).
 Mais certain formateur peuvent aussi calculer le temps que dure un exemple.
 Ainsi nous avons une facilité de détection des test les plus lent pour les
 refactorer et essayer d&#8217;améliorer le temps de réalisation de ses tests. Dans ce sens, j&#8217;ai moi même créer mon <a href="http://github.com/shingara/rspec-formatter">propre formateur Rspec</a>.
</p>

 <h2>Les tests partagés</h2>

<p>
Rspec dispose d&#8217;une possibilité sous estimés, les tests partagés. En effet, on peux définir
 certain jeux de test comme &#8220;partageable&#8221; on a ainsi la possibilité de les
 incorporer facilement dans divers tests. C&#8217;est une fonction vraiment pratique
 dans le cadre de test fonctionnel principalement. Plus besoin de
 copier/coller son code. :)
</p>

<h2>Compatibilité Test::Unit</h2>

<p>Le passage a Rspec est assez aisé de part sa compatibilité avec Test::Unit. En effet, si vous n&#8217;êtes pas familier ou que vous n&#8217;aimez pas la formalation <code>my_array.should be_empty</code>, rien ne vous y oblige. Vous pouvez tout à fait utiliser la syntaxe Test::Unit <code>assert my_array.empty?</code>. La migration s&#8217;en trouve très largement aisée.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/losdc-fr-2009-jy-serais.html">l&#8217;OSDC.fr 2009, j&#8217;y serais</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-17T00:00:00+02:00" pubdate data-updated="true">Sep 17<span>th</span>, 2009</time>
        
         | <a href="/losdc-fr-2009-jy-serais.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Le 2 et 3 Octobre aura lieu en première française, un rassemblement de
codeur d&#8217;environnement différent, <a href="http://act.osdc.fr/osdc2009fr/">l&#8217;OSDC.fr</a>. Cette conférence est organisé par les                                                     
associations françaises de Ruby (RubyFrance), Python (AFPy) et Perl (Mongueurs
    de Perl). Mais ce ne seront pas les seuls langage qui seront présenté. On peux ainsi trouver des sujets sur du PHP.</p>

<p>En tout cas je suis très heureux de pouvoir y présenter une petite
conférence sur <a href="http://cukes.info/">Cucumber</a>. J&#8217;espère vous y
retrouver.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/open-notification-v0-1-0-est-sortie.html">Open-notification v0.1.0 est sortie</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-08-08T00:00:00+02:00" pubdate data-updated="true">Aug 8<span>th</span>, 2009</time>
        
         | <a href="/open-notification-v0-1-0-est-sortie.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
Il y a maintenant un mois, j&#8217;ai commencé à jouer avec <a href="http://github.com/ezmobius/nanite">nanite</a>. Pour essayer un peu cette technologie, j&#8217;ai réaliser une mini application en sinatra et un agent nanite qui envoi des notifications par Jabber.
</p>

<p>
De fil en aiguille, le code s&#8217;est agrémenté et est surtout passé à Merb avec un système de persistance en CouchDB.
</p>

<p>
L&#8217;idée de base est extrêmement simple, gérer plein de notification de tous type. Il existe déjà ce genre de système comme <a href="http://messagepub.com">messagepub</a>. Mais là ca sera open source.
</p>

<p>
<a href="http://github.com/shingara/open-notification">Open notification</a> sort donc en version 0.1.0 pour sa première version. Le code sera mis sous licence <a href="http://www.fsf.org/licensing/licenses/agpl-3.0.html">AGPLv3</a>. Il est composé d&#8217;un agent nanite qui gére l&#8217;envoi des notifications jabber et d&#8217;une application avec Merb/CouchDB.
</p>

<p>
La méthode de déploiement est assez compliqué je l&#8217;avoue car il n&#8217;y a aucune documentation. Cela arrivera dans les prochaines versions.
</p>

<p>Une version complête est utilisable par tout un chacun sur <a href="http://open-notification.com">open-notification.com</a>. Ce service n&#8217;a pour l&#8217;instant aucune pérennité. Mais on verra dans le futur ce que ca donnera.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/dm-sweatshop-le-petit-truc-en-plus-par-rapport-a-factory-girl.html">DM-sweatshop, le petit truc en plus par rapport à Factory Girl</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-07-24T00:00:00+02:00" pubdate data-updated="true">Jul 24<span>th</span>, 2009</time>
        
         | <a href="/dm-sweatshop-le-petit-truc-en-plus-par-rapport-a-factory-girl.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>En jouant avec <a href="http://oupsnow.rubyforge.org">Oupsnow</a>, j&#8217;ai découvert une astuce sur <a href="http://github.com/datamapper/dm-more/tree/master/dm-sweatshop">DM-sweatshop</a> qui est vraiment génial. Aucun exemple n&#8217;indique ça et pourtant, c&#8217;est selon moi révolutionnaire et même un atout face à <a href="http://dev.thoughtbot.com/factory_girl/">Factory Girl</a>.</p>

<h2>dm-sweatshop</h2>

<p>
Pour ceux qui ne le savent pas dm-sweatshop est un gem de génération de donnée, inspiré de Factory Girl.
</p>

<p>
Factory Girl a été conçu pour éviter les fixtures dans Rails. Il a aussi l&#8217;avantage de permettre une meilleure vue des données présentes dans sa base de donnée durant son test. Je conseille tout à fait son utilisation et migre progressivement tous mes tests à l&#8217;utilisation de ce genre d&#8217;outil.
</p>

<p>
dm-sweatshop est le Factory Girl dédié à <a href="http://datamapper.github.com/">DataMapper</a>, même si Factory Girl peux tout à fait être utilisable avec DataMapper.
</p>

<h2>Son petit plus</h2>

<p>
dm-sweatshop contrairement à Factory gril, génére un Hash d&#8217;attribut, qu&#8217;il surcharge avec les données fournis et génére un objet à partir de ce hash. Ceci entraine par exemple, l&#8217;impossibilité d&#8217;utiliser les méthodes d&#8217;association, il faut directement associer les identifiants.
</p>

<p>
Mais là où est son petit plus est que justement à cause de cette génération d&#8217;un Hash, il y a un Proc qui est généré et rien n&#8217;empêche de mettre du code ruby pour générer d&#8217;autre objets ou récupérer des objets déjà existant. On peux ainsi écrire l&#8217;exemple suivant :
</p>

<typo:code lang="ruby">
Member.fixture {
 user = User.first(:login.not => &#8216;admin&#8217;) || User.gen!
 project = Project.first || Project.gen!
 not_project_id = []
 while project.has_member?(user)
   not_project_id << project.id
   project = Project.first(:id.not => not_project_id) || Project.gen!
 end
 { :user_id => user.id,
 :project_id => project.id,
 :function_id => (Function.first ? Function.first.id : Function.gen.id),}
}
</typo:code>

<p>
Dans cette exemple, je crée un objet Membre qui est la liaison entre un Projet et un User. Mais au préalable, j&#8217;ai récupéré et créé des éléments Projet et User si rien n&#8217;existait.
</p>

<p>
Grâce à dm-sweatshop, c&#8217;est enfin fini, les problèmes de multiples liaisons qui avec Factory Girl ne peuvent être contourné (d&#8217;après mon expérience en tout cas) ce qui entrainait la création de méthode complète pour créer tout ça. Désormais tout est au même endroit.
</p>
<p>
Je ne saurais donc vous encourager à utiliser dm-sweatshop sur tout projet DataMapper à la place de Factory Girl.
</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/observer-vs-callback.html">Observer Vs Callback</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-14T00:00:00+02:00" pubdate data-updated="true">Jun 14<span>th</span>, 2009</time>
        
         | <a href="/observer-vs-callback.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Il y a peu au boulot, j&#8217;ai indiqué ma désapprobation des Observeurs face au Callback. Je vais donc le coucher ici par écrit mon sentiment.</p>

<h2>L&#8217;Observeur</h2>

<p>Dans Rails, il y a au premier abord une fonctionnalité vraiment intéressante. L&#8217;<a href="http://api.rubyonrails.org/classes/ActiveRecord/Observer.html">Observeur</a>. Grâce à lui, on peux définir une classe qui vérifie le comportement d&#8217;un model et effectue certaine action suite à ses observations. Il permet d&#8217;ajouter des événements avant/après l&#8217;enregistrement, la mise a jour ou la destruction d&#8217;un model.</p>

<p>Pour mettre en place un observeur, il suffit de créer une classe héritant de <code>ActiveRecord::Observer</code>, mettre son code dedans et la définir comme observeur dans le fichier environment.rb. Rien de plus simple et ça marche très bien.</p>

<h2>Le Callback</h2>

<p>Mais Rails a déjà intégré dans ses models, les fonctions de callback utilisé par le observeur. En effet, on peux tout à fait définir N action after_save ou before_create. Ces méthodes seront appelés à l&#8217;événement voulu.</p>

<h2>Mais que choisir ?</h2>

<p>C&#8217;est là où je dis que le callback est plus intéressant que l&#8217;observeur. En effet, un callback fait exactement la même chose qu&#8217;un Observeur. Mais lui au moins on sait qu&#8217;il est là. En ouvrant la classe on découvre le callback. Pour détecter un Observeur, il faut regarder les fichiers de config de Rails et ouvrir une à une les classes Observeurs.</p>

<p>Même le cas du nombre de ligne n&#8217;est pas réel car il est tout à fait possible de sortir ses callbacks dans des modules. De même pour une réutilisation sur plusieurs classes. Le module le permet sans problème.</p>

<p>Personnellement, je n&#8217;ai jamais constater un seul cas où l&#8217;observeur avait plus d&#8217;intérêt que des callback. Si vous en trouvez, je suis vraiment curieux.</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/telecharger-fichier-de-basecamp.html">Récupération de ses fichiers sur basecamp</a>
      </li>
    
      <li class="post">
        <a href="/translate-on-mongoid.html">Localize avec mongoid</a>
      </li>
    
      <li class="post">
        <a href="/mailtrap-l-aide-au-staging.html">Mailtrap l&#8217;aide au staging</a>
      </li>
    
      <li class="post">
        <a href="/une-journee-dediee-i-mongodb.html">Une journée dédiée à MongoDB</a>
      </li>
    
      <li class="post">
        <a href="/periodictimer-de-eventmachine-le-cron-simplifie.html">PeriodicTimer de EventMachine, le cron simplifié</a>
      </li>
    
      <li class="post">
        <a href="/oupsnow-0-5-0-est-sortie.html">Oupsnow 0.5.0 est sortie</a>
      </li>
    
      <li class="post">
        <a href="/pourquoi-ruby-et-ruby-on-rails-dans-le-developpement-dapplication-web.html">Pourquoi Ruby et Ruby On Rails dans le développement d&#8217;application web ?</a>
      </li>
    
      <li class="post">
        <a href="/que-cherche-un-developpeur-dans-une-offre-demploi.html">Que cherche un développeur dans une offre d&#8217;emploi ?</a>
      </li>
    
      <li class="post">
        <a href="/sortie-de-typo-5-4-0.html">Sortie de Typo 5.4.0</a>
      </li>
    
      <li class="post">
        <a href="/sortie-de-oupsnow-0-4-0.html">Sortie de Oupsnow 0.4.0</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/shingara">@shingara</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'shingara',
            count: 10,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("shingara", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/shingara" class="twitter-follow-button" data-show-count="true">Follow @shingara</a>
  
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Cyril Mougel -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'shinydevblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
