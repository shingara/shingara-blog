---
layout: post
title: Sortir un test Junit à partir d'un test Junit d'Eclipse
typo_id: 69
---
<p>Au niveau de mon travail, on m'a demandé de réaliser une sortie console de nos tests unitaires. Hélas on a jamais pris le temps de réaliser un pom.xml complet (pour projet Maven) pour ainsi avoir toutes les dépendances nécessaires.</p>

<p>Comme toujours on m'a demandé de réaliser cette sortie assez rapidement. J'ai donc trouvé une petite bidouille pour arriver à réaliser mon test en console en conservant complètement mon classpath défini par Eclipse.</p>

<p>Tout d'abord il faut récupérer la commande réaliser par Eclipse pour lancer le test. Pour cela, il suffit de mettre un point d'arrêt dans son script Junit, lancer le script en mode « Debug » et ensuite quand le point d'arrêt à stopper le processus, un clic droit sur le thread permet de consulter le menu de propriété de lancement de ce thread.</p>

<p>On copie entièrement la ligne de commande qui est de la forme suivante :</p>

<pre>
C:\bea\jdk142_05\bin\javaw.exe -classpath ${CLASSPATH_DE_LANCEMENT}
-Xdebug 
-Xnoagent
-Xrunjdwp:transport=dt_socket,suspend=y,address=localhost:1859 
org.eclipse.jdt.internal.junit.runner.RemoteTestRunner 
-version 3 
-port 1858 
-testLoaderClass Org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestLoader
-classNames ${CLASSE_LANCER_POUR_LE_TEST}
</pre>

<p>Dans mon exemple les variables ${} sont bien sûr différente. Je les ai remplacé pour limiter un peu la place prise par la ligne de commande.</p>

<p>Maintenant que vous avez cette ligne de commande, il suffit de faire quelque modification dessus et vous aurez votre ligne de commande complète. Les modifications à réaliser sont les suivantes :</p>

<ul>
<li>Suppression de l'option -Xdebug</li>
<li>Suppression de l'option -Xnoagent</li>
<li>Suppression de l'option -Xrunjdwp:transport=dt_socket,suspend=y,address=localhost:1859</li>
<li>Suppression de -port 1858 </li>
<li>Transformer l'exécutable de lancement pas java.exe au lieu de javaw.exe</li>
<li>Transformer la classe de lancement par junit.textui.TestRunner au lieu de org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestLoader qui est spécifique à Eclipse.</li>
</ul>

<p>Maintenant que vous avez réalisé tous ces petits changements vous pouvez désormais lancer la ligne de commande obtenu de la façon suivante :</p>

<pre>C:\bea\jdk142_05\bin\java.exe 
-classpath ${CLASSPATH_DE_LANCEMENT} 
junit.textui.TestRunner 
-version 3 
-classNames ${CLASSE_LANCER_POUR_LE_TEST}</pre>

<p>Bien sûr il y a d'autres techniques qui sont de simplement récupérer le CLASSPATH par exemple et de le mettre dans notre ligne de commande.</p>
